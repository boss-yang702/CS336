2025-06-27 21:23:36,422 - INFO - Training with config: {'dataset_name': 'tinystory', 'context_length': 256, 'batch_size': 8, 'device': 'mps', 'vocab_size': 10000, 'context_size': 1024, 'num_layers': 4, 'd_model': 512, 'num_heads': 16, 'd_ff': 1344, 'attn_pdrop': 0.1, 'resid_pdrop': 0.1, 'init_from': 'scratch', 'total_iters': 20000, 'warmup_iters': 200, 'cosine_cycle_iters': None, 'max_learning_rate': 0.0005, 'min_learning_rate': 0, 'weight_decay': 0.001, 'wandb_logging': True, 'wandb_project': 'cs336-assignment1', 'wandb_run_name': 'tinystories-baseline', 'log_interval': 20, 'eval_interval': 200, 'eval_iters': 100, 'no_rmsnorm': False, 'parallel_layers': False, 'post_norm': False}
2025-06-27 21:23:37,127 - INFO - number of non-embeding parameters: 8.23
2025-06-27 21:23:40,288 - INFO - Iter: 0, Train loss: 9.2567, LR: 0.000000, Time: 2957.15ms
2025-06-27 21:23:42,630 - INFO - Iter: 0, Val loss: 9.2455, LR: 0.000000
2025-06-27 21:23:44,655 - INFO - Iter: 20, Train loss: 9.0746, LR: 0.000050, Time: 80.85ms
2025-06-27 21:23:46,288 - INFO - Iter: 40, Train loss: 8.4078, LR: 0.000100, Time: 80.08ms
2025-06-27 21:23:47,912 - INFO - Iter: 60, Train loss: 6.5404, LR: 0.000150, Time: 80.48ms
2025-06-27 21:23:49,534 - INFO - Iter: 80, Train loss: 5.6244, LR: 0.000200, Time: 80.31ms
2025-06-27 21:23:51,158 - INFO - Iter: 100, Train loss: 5.2883, LR: 0.000250, Time: 81.08ms
2025-06-27 21:23:52,794 - INFO - Iter: 120, Train loss: 4.7720, LR: 0.000300, Time: 81.22ms
2025-06-27 21:23:54,423 - INFO - Iter: 140, Train loss: 4.5393, LR: 0.000350, Time: 82.31ms
2025-06-27 21:23:56,065 - INFO - Iter: 160, Train loss: 4.2378, LR: 0.000400, Time: 80.28ms
2025-06-27 21:23:57,808 - INFO - Iter: 180, Train loss: 4.1824, LR: 0.000450, Time: 105.94ms
Traceback (most recent call last):
  File "/Users/charon/miniconda3/envs/llm/lib/python3.10/runpy.py", line 187, in _run_module_as_main
    mod_name, mod_spec, code = _get_module_details(mod_name, _Error)
  File "/Users/charon/miniconda3/envs/llm/lib/python3.10/runpy.py", line 110, in _get_module_details
    __import__(pkg_name)
  File "/Users/charon/Documents/GitHub/CS336/basics/train.py", line 122, in <module>
    lr = get_cosine_lr(iter_num, **asdict(config))
  File "/Users/charon/Documents/GitHub/CS336/basics/optimizer.py", line 22, in get_cosine_lr
    if it > cosine_cycle_iters:
TypeError: '>' not supported between instances of 'int' and 'NoneType'
Traceback (most recent call last):
  File "/Users/charon/miniconda3/envs/llm/lib/python3.10/runpy.py", line 187, in _run_module_as_main
    mod_name, mod_spec, code = _get_module_details(mod_name, _Error)
  File "/Users/charon/miniconda3/envs/llm/lib/python3.10/runpy.py", line 110, in _get_module_details
    __import__(pkg_name)
  File "/Users/charon/Documents/GitHub/CS336/basics/train.py", line 122, in <module>
    lr = get_cosine_lr(iter_num, **asdict(config))
  File "/Users/charon/Documents/GitHub/CS336/basics/optimizer.py", line 22, in get_cosine_lr
    if it > cosine_cycle_iters:
TypeError: '>' not supported between instances of 'int' and 'NoneType'
